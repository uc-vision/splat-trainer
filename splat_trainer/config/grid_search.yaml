# @package _global_

defaults:
  - logger: wandb
  - controller: target
  - scene: sh
  - trainer: default
  - test_datasets: default
  - color_corrector: nil
  - /hydra/callbacks:
    - manage_rq_workers
    - average_result
  - override hydra/launcher: rq_launcher
  - _self_


trainer:
  save_checkpoints: False
  save_output: False

  steps: 20000

test_scene: ???

worker_machines: test

hydra:
  sweep:
    dir: multirun/${now:%Y-%m-%d}/${now:%H-%M-%S}
    subdir: ${run_name:${hydra:overrides.task}}_/${hydra.job.num}__test_scene=${test_scene}
  job:
    chdir: False
    config:
      override_dirname:
        exclude_keys:
         - test_scene
  mode: MULTIRUN
  sweeper:
    params:
      # test_scene: scan_1457_east, scan_23, bonsai, scan_1457_west, room, scan_21, bicycle, counter, flowers, garden, kitchen, stump, treehill
      # trainer.load_dataset_cloud: True, False
      # trainer.add_initial_points: True, False

      # trainer.add_initial_points: False, True  # if true, add extra random points to the point cloud

      # trainer.reg_loss_weight: choice([1, 1, 1], [0, 0, 0], [1, 0, 0], [0, 1, 0], [0, 0, 1], [1, 1, 0], [1, 0, 1], [0, 1, 1])
      # scene: sh, tcnn
      # trainer.reg_loss_weight: choice([1,0,0], [0,0,1], [1,1,0], [0,1,1])
      # trainer.reg_loss_weight: choice([1,0,0], [0,0,1])
      # color_corrector: nil, bilateral
      test_scene: scan_23, scan_1457_west, scan_1457_east
      # trainer.scene.parameters.log_scaling.lr: choice(0.05077193002287146, 0.04905011407053165)
      # trainer.num_neighbors: 3, 4
      # trainer.initial_alpha: 0.2, 0.3
      # trainer.initial_point_scale: 0.2, 0.3, 0.4
      # test_scene: scan_21, scan_1457_west, treehill, kitchen, counter, flowers, bonsai, scan_23, room


optimize_algorithm: grid_search

project: ${sanitize:${hydra:sweep.dir}}__${project_name:${hydra:overrides.task}}
group_name: ${group_name:${hydra:overrides.task}}
run_name: ${conditional_run_name:${optimize_algorithm},${group_name},${format:${hydra:job.num}},${run_name:${hydra:overrides.task}}}


wait_exit: False
debug: False
